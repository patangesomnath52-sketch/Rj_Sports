<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium Footwear | RJ Sports</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script>
        if(localStorage.getItem('rj_theme') === 'dark') { document.documentElement.classList.add('dark-mode'); }
    </script>
    <style>
        :root { --bg: #f4f6f8; --text: #1f2937; --header: #fff; --accent: #ff3f6c; --border: #e5e7eb; }
        .dark-mode { --bg: #121212; --text: #e5e7eb; --header: #1f2937; --border: #374151; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Assistant', sans-serif; }
        body { background-color: var(--bg); color: var(--text); transition: 0.3s; min-height: 100vh; }
        .header { background: var(--header); padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .logo { font-size: 24px; font-weight: 900; text-decoration: none; color: var(--text); }
        .logo span { color: var(--accent); }
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
        .card { background: var(--header); border-radius: 12px; border: 1px solid var(--border); overflow: hidden; position: relative; padding-bottom: 15px; transition: 0.3s; }
        .img-container { width: 100%; height: 280px; position: relative; overflow: hidden; background: #fff; }
        .slider { display: flex; overflow-x: auto; scroll-snap-type: x mandatory; height: 100%; scroll-behavior: smooth; }
        .slider::-webkit-scrollbar { display: none; }
        .slider img { flex: 0 0 100%; width: 100%; height: 100%; object-fit: cover; scroll-snap-align: start; }
        .dots { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); display: flex; gap: 5px; }
        .dot { width: 6px; height: 6px; background: rgba(0,0,0,0.2); border-radius: 50%; }
        .dot.active { background: var(--accent); width: 12px; border-radius: 10px; }
        .info { padding: 15px; }
        .brand { font-size: 12px; font-weight: 800; color: #878787; text-transform: uppercase; }
        .price { color: var(--accent); font-weight: 800; font-size: 18px; margin: 5px 0; }
        .size-btn { width: 34px; height: 34px; border-radius: 50%; border: 1px solid var(--border); background: none; color: var(--text); cursor: pointer; margin: 2px; font-weight: 600; font-size: 12px; }
        .size-btn.selected { background: var(--accent); color: white; border-color: var(--accent); }
        .size-btn:disabled { text-decoration: line-through; opacity: 0.3; cursor: not-allowed; }
        .add-btn { width: 90%; margin: 10px auto; display: block; padding: 10px; border: 2px solid var(--accent); color: var(--accent); font-weight: 800; border-radius: 6px; cursor: pointer; background: none; }
        .add-btn:hover:not(:disabled) { background: var(--accent); color: white; }
        .badge { position: absolute; top: 10px; right: 10px; background: red; color: white; padding: 4px 8px; font-weight: bold; border-radius: 4px; font-size: 10px; z-index: 10; }
        .sold-out { opacity: 0.6; pointer-events: none; }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr 1fr; gap: 15px; } .img-container { height: 200px; } }
    </style>
</head>
<body>

<header class="header">
    <a href="index.html" class="logo">RJ <span>SPORTS</span></a>
    <div style="position:relative;"><a href="cart.html" style="text-decoration:none; font-size:20px;">ðŸ›’ <span id="cart-count" style="background:var(--accent); color:white; border-radius:50%; padding:2px 6px; font-size:10px;">0</span></a></div>
</header>

<div class="container">
    <h2 style="margin-bottom: 25px;">Premium Footwear Collection</h2>
    <div class="grid" id="footwear-grid">
        
        <div class="card" data-id="s1" data-name="Puma Nitro Red Runner" data-price="2499">
            <div class="img-container">
                <div class="slider" onscroll="updateDots(this)">
                    <img src="puma nitro red runner.jpeg">
                    <img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=600">
                    <img src="https://images.unsplash.com/photo-1608231387042-66d1773070a5?q=80&w=600">
                </div>
                <div class="dots"><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
            </div>
            <div class="info">
                <span class="brand">Puma</span><h3 class="name">Nitro Red Runner</h3><p class="price">â‚¹2,499</p>
                <div class="sizes">
                    <button class="size-btn" onclick="selectSize(this)">6</button>
                    <button class="size-btn" onclick="selectSize(this)">7</button>
                    <button class="size-btn" onclick="selectSize(this)">8</button>
                    <button class="size-btn" onclick="selectSize(this)">9</button>
                    <button class="size-btn" onclick="selectSize(this)">10</button>
                </div>
            </div>
            <button class="add-btn" onclick="addToCart(this)">ADD TO CART</button>
        </div>

        <div class="card" data-id="s2" data-name="Puma Sky Blue Sneakers" data-price="1899">
            <div class="img-container">
                <div class="slider" onscroll="updateDots(this)">
                    <img src="pumma skyblue sneakers.jpeg">
                    <img src="https://images.unsplash.com/photo-1525966222134-fcfa99b8ae77?q=80&w=600">
                    <img src="https://images.unsplash.com/photo-1549298916-b41d501d3772?q=80&w=600">
                </div>
                <div class="dots"><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
            </div>
            <div class="info">
                <span class="brand">Puma</span><h3 class="name">Sky Blue Sneakers</h3><p class="price">â‚¹1,899</p>
                <div class="sizes">
                    <button class="size-btn" onclick="selectSize(this)">6</button>
                    <button class="size-btn" onclick="selectSize(this)">7</button>
                    <button class="size-btn" onclick="selectSize(this)">8</button>
                    <button class="size-btn" onclick="selectSize(this)">9</button>
                    <button class="size-btn" onclick="selectSize(this)">10</button>
                </div>
            </div>
            <button class="add-btn" onclick="addToCart(this)">ADD TO CART</button>
        </div>

        <div class="card" data-id="s3" data-name="HiGrip Black Runner" data-price="1299">
            <div class="img-container">
                <div class="slider" onscroll="updateDots(this)">
                    <img src="fashion rung runner.jpeg">
                    <img src="https://images.unsplash.com/photo-1595950653106-6c9ebd614d3a?q=80&w=600">
                    <img src="https://images.unsplash.com/photo-1584735175315-9d5df23860e6?q=80&w=600">
                </div>
                <div class="dots"><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
            </div>
            <div class="info">
                <span class="brand">HiGrip</span><h3 class="name">Black Runner</h3><p class="price">â‚¹1,299</p>
                <div class="sizes">
                    <button class="size-btn" onclick="selectSize(this)">6</button>
                    <button class="size-btn" onclick="selectSize(this)">7</button>
                    <button class="size-btn" onclick="selectSize(this)">8</button>
                    <button class="size-btn" onclick="selectSize(this)">9</button>
                    <button class="size-btn" onclick="selectSize(this)">10</button>
                </div>
            </div>
            <button class="add-btn" onclick="addToCart(this)">ADD TO CART</button>
        </div>

        <div class="card" data-id="s4" data-name="Puma Classic B&W" data-price="1999">
            <div class="img-container">
                <div class="slider" onscroll="updateDots(this)">
                    <img src="puma black runner.jpeg">
                    <img src="https://images.unsplash.com/photo-1600185365483-26d7a4cc7519?q=80&w=600">
                    <img src="https://images.unsplash.com/photo-1512374382149-4332c6c021f1?q=80&w=600">
                </div>
                <div class="dots"><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
            </div>
            <div class="info">
                <span class="brand">Puma</span><h3 class="name">Classic B&W</h3><p class="price">â‚¹1,999</p>
                <div class="sizes">
                    <button class="size-btn" onclick="selectSize(this)">6</button>
                    <button class="size-btn" onclick="selectSize(this)">7</button>
                    <button class="size-btn" onclick="selectSize(this)">8</button>
                    <button class="size-btn" onclick="selectSize(this)">9</button>
                    <button class="size-btn" onclick="selectSize(this)">10</button>
                </div>
            </div>
            <button class="add-btn" onclick="addToCart(this)">ADD TO CART</button>
        </div>

        <div class="card" data-id="s5" data-name="ProNine Sport White" data-price="999">
            <div class="img-container">
                <div class="slider" onscroll="updateDots(this)">
                    <img src="pro nine sports.jpeg">
                    <img src="https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?q=80&w=600">
                    <img src="https://images.unsplash.com/photo-1543508282-6319a3e2621f?q=80&w=600">
                </div>
                <div class="dots"><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
            </div>
            <div class="info">
                <span class="brand">ProNine</span><h3 class="name">Sport White</h3><p class="price">â‚¹999</p>
                <div class="sizes">
                    <button class="size-btn" onclick="selectSize(this)">6</button>
                    <button class="size-btn" onclick="selectSize(this)">7</button>
                    <button class="size-btn" onclick="selectSize(this)">8</button>
                    <button class="size-btn" onclick="selectSize(this)">9</button>
                    <button class="size-btn" onclick="selectSize(this)">10</button>
                </div>
            </div>
            <button class="add-btn" onclick="addToCart(this)">ADD TO CART</button>
        </div>

        <div class="card" data-id="s7" data-name="Nike Smile Edition" data-price="2999">
            <div class="img-container">
                <div class="slider" onscroll="updateDots(this)">
                    <img src="nike.jpeg">
                    <img src="https://images.unsplash.com/photo-1515955656352-a1fa3ffcd111?q=80&w=600">
                    <img src="https://images.unsplash.com/photo-1552346154-21d32810aba3?q=80&w=600">
                </div>
                <div class="dots"><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
            </div>
            <div class="info">
                <span class="brand">Nike</span><h3 class="name">Smile Edition</h3><p class="price">â‚¹2,999</p>
                <div class="sizes">
                    <button class="size-btn" onclick="selectSize(this)">6</button>
                    <button class="size-btn" onclick="selectSize(this)">7</button>
                    <button class="size-btn" onclick="selectSize(this)">8</button>
                    <button class="size-btn" onclick="selectSize(this)">9</button>
                    <button class="size-btn" onclick="selectSize(this)">10</button>
                </div>
            </div>
            <button class="add-btn" onclick="addToCart(this)">ADD TO CART</button>
        </div>

    </div>
</div>

<script>
    function updateDots(s) {
        const i = Math.round(s.scrollLeft / s.offsetWidth);
        const d = s.parentElement.querySelectorAll('.dot');
        d.forEach((dot, idx) => dot.classList.toggle('active', idx === i));
    }

    async function applyLiveStock() {
        try {
            const res = await fetch('/api/stock');
            const data = await res.json();
            if(data.success) {
                data.stocks.forEach(st => {
                    const c = document.querySelector(`.card[data-id="${st.productId}"]`);
                    if(!c) return;
                    if(st.isOutOfStock) {
                        c.classList.add('sold-out');
                        const b = document.createElement('div'); b.className='badge'; b.innerText='SOLD OUT'; c.appendChild(b);
                        c.querySelector('.add-btn').innerText='OUT OF STOCK'; c.querySelector('.add-btn').disabled=true;
                    }
                    if(st.disabledSizes) {
                        st.disabledSizes.forEach(sz => {
                            const b = Array.from(c.querySelectorAll('.size-btn')).find(btn => btn.innerText == sz);
                            if(b) b.disabled = true;
                        });
                    }
                });
            }
        } catch (e) { console.log(e); }
    }

    function selectSize(b) {
        b.parentElement.querySelectorAll('.size-btn').forEach(btn => btn.classList.remove('selected'));
        b.classList.add('selected');
    }

    function addToCart(btn) {
        const c = btn.closest('.card');
        const s = c.querySelector('.size-btn.selected');
        if(!s) return alert("Please select size!");
        let cart = JSON.parse(localStorage.getItem('rj_cart')) || [];
        cart.push({ id: c.dataset.id, name: c.dataset.name, price: c.dataset.price, size: s.innerText, image: c.querySelector('img').src, quantity: 1 });
        localStorage.setItem('rj_cart', JSON.stringify(cart));
        window.location.href = 'cart.html';
    }

    window.onload = applyLiveStock;
</script>
</body>
</html>